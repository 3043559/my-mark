# 如何提高机器速度

## 提高访存速度

- 高速芯片
- [[../第4章 存储器/4.3 高速缓冲存储器|Cache]]
- 多体并行：对多个存储体交叉访问

## 提高IO和主机之间的传送速度

- [[../第5章 输入输出设备/5.5 程序中断方式|中断]]
- [[../第5章 输入输出设备/5.6 DMA方式|DMA]]
- [[../第5章 输入输出设备/5.1 概述#具有通道结构的阶段|通道]]
- [[../第5章 输入输出设备/5.1 概述#具有IO处理机的的阶段|IO处理机]]
- 多总线

## 提高运算速度

- 高速芯片
- 改进算法
- [[../第6章 计算机的运算方法/6.5 算数逻辑单元#快速进位链|快速进位链]]

## 提高整机处理能力

- 高速器件
- 改进系统结构，开发系统的并行性

# 系统的并行性

并行性

- 并发：两个或多个以上的事件在*同一时间段*发生
- 同时：两个或两个以上的事件在*同一时刻*发生

并行性的等级

- 过程级（程序、进程）：两个或以上的指令在同时被解析，粗粒度
- 指令级：细粒度
  - 指令之间
  - 指令内部

# 指令流水原理

## 指令的串行执行

![[vx_images/Pasted image 20240304152222.png]]

- 取指令：只会使用取指令部件完成
- 执行指令：只会使用执行指令部件完成

> 总结：总有一个部件是空闲状态

## 指令的二级流水

![[vx_images/Pasted image 20240304152448.png]]

取指和执行阶段时间上完全重叠，执行周期减半，速度提高1倍
> 总结：理想状态下的最优解，现实很难达到

## 影响指令流水效率加倍的因素

- 执行时间大于取指时间

```mermaid
graph LR
取指令-->指令缓冲区--> 执行指令部件
```

- [[../第7章 指令系统/7.2 操作数类型和操作类型#转移|条件转移]]指令对指令流水的影响
：必须等上条指令执行结束，才能确定下条指令的地址，从而造成时间损失

> 可采用分支预测的方法解决

## 指令的六级流水

![[vx_images/Pasted image 20240304155044.png]]

- FI：取指令
- DI：指令译码
- CO：形成操作数地址
- FO：取操作数
- EI：执行
- WO：结果写回，写道给的位置

完成一条指令需要6个时间单位

- 串行执行：54个时间单位
- 六级流水：14个时间单位（理想情况）

# 影响指令流水性能的因素

## 结构相关

不同指令争夺同一功能部件产生资源冲突
![[vx_images/Pasted image 20240304155632.png]]
如上图，会产生很多冲突

解决办法

- 停顿，加入气泡
- 指令存储器和数据存储器分开
- 指令预取技术（适用于访存周期短的情况）

## 数据相关

不同指令因重叠操作，可能改变操作数的读写访问顺序

- 写后读相关（RAW）
  - `SUB R1,R2,R3 ; (R2)-(R3)->R1`
  - `ADD R4,R5,R1 ; (R5)+(R1)->R4`

- 读后写相关（WAR）
  -

- 写后写相关（WAW）
